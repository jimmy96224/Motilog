<div class="row justify-content-center">
  <% if !@user.is_active %>
    <h2 class="text-danger font-weight-bold">退会もしくは停止中のユーザー</h2>
  <% end %>
</div>

<div class="row justify-content-center">
    <h3><%= @user.goal %></h3>
</div>

<div class="row">
  <div class="col-lg-4">
    <div class="col-lg-12">
      <%= render 'layouts/user_info' %>
    </div>
  </div>

  <div class="col-lg-8">
    <div class="row">
      <div class= "col-12">
          <h2 class="m-0">日誌</h2>
        <table class="table table-hover">
         <thead>
             <tr>
              <th></th>
              <th class="text-center">楽器</th>
              <th class="text-center">日付</th>
              <th class="text-center">タグ</th>
              <th class="text-center">タイトル</th>
              <th></th>
             </tr>
         </thead>
          <tbody>
          <% @diaries.each do |diary| %>
             <tr>
                 <td>
                    <% if diary.diary_image.attached? %>
                      <%= image_tag diary.get_diary_image(50, 50) %>
                      <% else %>
                    <% end %>
                 </td>
                 <td>
                   <%= link_to user_instrument_path(user_id: diary.user_id, id: diary.instrument.id) do %>
                     <%= diary.instrument.name %>
                   <% end %>
                  </td>
                 <td><%= diary.date %></td>
                 <td>
                    <% diary.tag_list.each do |tag|%>
                    <div class="btn btn-primary">
                    <%= link_to tag, user_path(id: @user, tag_name: tag, filtered_by_tag: true), class: "text-white" %>
                    </div>
                    <% end %>
                 </td>
                 <td>
                   <%= link_to admin_user_diary_path(user_id: diary.user_id, id: diary.id) do %>
                     <%=truncate(diary.title, length: 20)%>
                   <% end %>
                  </td>
                 <td>
                   <div>
                   <% if diary.post_comments.present? %>
                     <%= diary.post_comments.count %> <i class="fas fa-comment"></i>
                   <% end %>
                   </div>
                   <div>
                   <% if diary.favorites.present? %>
                     <%= diary.favorites.count %> <i class="fas fa-thumbs-up"></i>
                   <% end %>
                   </div>
                 </td>
             </tr>
          <% end %>
         </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="row d-flex justify-content-center">
  <div class="col-7 d-flex justify-content-center align-items-center border rounded p-3 shadow">

    <%= form_with model: @user, url: admin_user_path(@user), method: :patch do |f| %>

    <div class="font-weight-bold mt-3 form-group text-center">
      <%= f.label :is_active, "会員ステータス" %>
    </div>

    <div class="form-row m-3">
      <div class="form-inline ">
        <%= f.radio_button :is_active, :true, checked: @user.is_active, class:"form-control" %>
        <%= label_tag 'is_active_true', '有効', class:"mr-5" %>
        <%= f.radio_button :is_active, :false, checked: !@user.is_active, class:"ml-5 form-control" %>
        <%= label_tag 'is_active_false', '退会' %>
      </div>
    </div>

    <div class="d-flex justify-content-center">
      <%= f.submit "変更を保存",class: "btn btn-success form-control w-50" %>
    </div>

    <% end %>

  </div>
</div>